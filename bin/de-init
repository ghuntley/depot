#!/usr/bin/env bash
# Copyright (c) 2020 Geoffrey Huntley <ghuntley@ghuntley.com>. All rights reserved.
# SPDX-License-Identifier: Proprietary

set -Eeuo pipefail

# 0. Configure git
echo "[dev-env] Configuring git"
git config --local color.ui true

## merge behaviours
git config --local merge.conflictstyle "diff3"
git config --local pull.rebase true
git config --local rebase.autosquash true
git config --local rebase.autostash true

## monorepo tweaks
git config --local feature.manyFiles true
git config --local fetch.recurseSubmodules true

# 1. Install git-hooks
bash "$REPO_ROOT/bin/de-install-git-hooks"

# 2. Bootstrap third_party git submodules
echo "[dev-env] Synchronizing git submodules"
git submodule sync
git submodule update

# n. Notify
echo "[dev-env] Initialization complete"
echo